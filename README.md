# Курсовой проект: Главная страница с финансовой статистикой

## Описание

Данный проект реализует набор функций для обработки финансовых данных пользователя и генерации JSON-ответа с информацией о:

- О приветствии в зависимости от времени суток
- Статистике по банковским картам (расходы, кешбэк)
- Топ-5 транзакций по сумме платежа
- Курсах валют
- О ценах акций из S&P500
- Расчет суммы для инвестирования в «Инвесткопилку»
- Поиск транзакций с телефонными номерами в описании
- Анализ выгодных категорий повышенного кешбэка

## Установка и использование

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/your_username/course_work_1.git
   cd course_work_1
2. Создайте и активируйте виртуальное окружение:

   ``` bash
   python -m venv .venv
   source .venv/bin/activate      # Linux/macOS
   .venv\Scripts\activate         # Windows

3. Установите зависимости:

   ```bash
   pip install -r requirements.txt

4. Создайте .env файл в корне проекта и добавьте туда ключ API Alpha Vantage:

   ```ini
   API_KEY=ваш_ключ
   
5. Запустите скрипт, передав дату и время в формате YYYY-MM-DD HH:MM:SS:

   ```python
   from src.views import generate_main_page_data
   data = generate_main_page_data("2024-12-20 14:30:00")
   print(data)
   
## Логирование
Проект использует стандартный модуль logging для информирования о процессе выполнения функций и возможных ошибках.
Настройки логирования заданы в src, можно изменить уровень логирования и формат вывода при необходимости.

## Требования
- Python 3.8+ 
### Библиотеки:
- datatime
- json
- logging
- pandas
- python-dotenv
- pytest
- pytest-cov
- re 
- requests

Все зависимости перечислены в requirements.txt.

## Структура проекта
   ```bash

   course_work_1/
   │
   ├── src/
   │   ├── __init__.py
   │   ├── views.py           # Основная логика проекта
   │   ├──services.py         # Сервисы
   │   └──reports.py          # Отчеты
   │
   ├── tests/
   │   ├── __init__.py
   │   ├── test_views.py      # Тесты для функций из src/views.py
   │   ├── test_services.py   # Тесты для функций из src/services.py
   │   └── test_reports.py    # Тесты для функций из src/reports.py
   │
   ├── data/
   │   └── operations.csv     # CSV с операциями пользователя
   │
   ├── user_settings.json     # Пользовательские настройки (валюты, акции)
   ├── .env                   # Файл с переменными окружения (API_KEY)
   ├── requirements.txt       # Зависимости проекта
   └── README.md              # Документация (этот файл)
   ```

## Тестирование
В проекте написаны тесты с использованием pytest. 
### test_views.py
Тесты содержат:
- Проверка корректности приветствия по времени
- Проверка подсчёта статистики по картам
- Проверка фильтрации операций по дате
- Проверка получения курсов валют и цен акций с моками API-запросов
### test_services.py
В тестах проверяется корректность:
- Расчёта инвесткопилки
- Поиска транзакций с номерами телефонов
- Анализа кешбэка по категориям
### test_reports.py 
Тесты проверяют:
- правильность подсчёта средних трат
- корректность фильтрации по дате
- игнорирование положительных сумм (доходов)
- корректность формата и ключей JSON-ответа

### Запуск тестов
Запустите тесты командой:

   ```bash
   pytest tests
   ```

### Отчёт о покрытии тестами
Для генерации отчёта о покрытии кода тестами используйте:

```bash
pytest --cov=src --cov-report=html
```
Отчёт будет создан в папке htmlcov, откройте файл htmlcov/index.html в браузере для просмотра.